<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/styles.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='index.js') }}"></script>
    <title>Flack</title>
  </head>
  <body>
    <div class="grid-container">
      <div class="item1">
        <p class="display-4">Welcome to Flack!</p>
        <p class="lead">A Slack copycat app</p>
      </div>
      <div class="item2">
        <h4>Your Channels</h4>
        <div id="channelAlertSpace">
        </div>
        <div class="input-group mb3">
          <div class="input-group-prepend">
            <button class="btn btn-primary" id="channelCreate">Create</button>
          </div>
          <input type="text" class="form-control" placeholder="Enter new channel name" id="newChannelName">
        </div>
        <br>
        <ul id="channelDisplay">
        </ul>
      </div>
      <div class="item3">
        <div class="hide" id="newUserForm">
          <h4>Looks like you're new!</h4>
          <p class="lead">Please enter new user name below</p>
          <div class="input-group mb-3" style="width: 25%; margin: auto">
            <div class="input-group-prepend">
              <button class="btn btn-primary" id='newUserCreate'>Create</button>
            </div>
            <input type="text" class="form-control" placeholder="Enter new user name" id="newUserInput">
          </div>
        </div>
        <div class="hide" id="returnUserGreeting">
        </div>
      </div>
      <div class="item4">Footer
      </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        //localStorage.clear()
        //variables for different divs depending on what's in localStorage
        let returnGreeting = document.querySelector("#returnUserGreeting")
        let newUserSpace = document.querySelector("#newUserForm")
        let channelSpace = document.querySelector(".item2")
        //let channelDisplay = document.querySelector("#channelDisplay")
        //let channelCreate = document.querySelector("#channelCreate")
        //let newChannel = document.querySelector("#newChannelName")
        //let channelList = ''
        let userName = ''

        //check to see if channel list exists
        //localStorage.getItem('channelList') ? channelList = localStorage.getItem('channelList') : ''
        localStorage.getItem('userName') ? userName = localStorage.getItem('userName') : ''

        //check to see if user already has a stored username
          if (userName != '')
            greeting('returnUser', userName, returnGreeting, newUserSpace)
          else {
            newUserSpace.style.visibility = "visible"
            //createInputForm("Enter new username here", "Create", newUserSpace, 'newUserCreate', 'newUserInput', '25%')

            newUserCreate.onclick = () => {
              if (newUserInput.value) {

                let userName = newUserInput.value
                localStorage.setItem('userName', userName)

                greeting('newUser', userName, returnGreeting, newUserSpace)
              }
            }
          }
          //load channels already stored in memory when page loads
          //channelList != '' ? channelList.trim().split('     ').forEach(channel => channelDisplay.innerHTML += `<li>${channel}</li>`) : channelDisplay.innerHTML = "<em>No channels yet!</em>"

          //handle channel Creation
          /*channelCreate.onclick = () => {
            let newChannelName = newChannel.value
            //store in memory
            if (channelList != '') {
              channelList += (newChannelName + '     ')
              localStorage.setItem('channelList', channelList)
            } else {
              channelList += (newChannelName + '     ')
              localStorage.setItem('channelList', (newChannelName + '     '))
            }
            channelDisplay.innerHTML += `<li>${newChannelName}</li>`
          }*/

      })
    </script>
  </body>
</html>
