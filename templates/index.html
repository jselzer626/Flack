<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/styles.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="{{ url_for('static', filename='index.js') }}"></script>
    <title>Flack</title>
  </head>
  <body>
    <div class="grid-container">
      <div class="item1">
        <p class="display-4">Welcome to Flack!</p>
        <p class="lead">A Slack copycat app</p>
      </div>
      <div class="item2" id="userName">Menu
        <p class="lead">Sample Text</p>
      </div>
      <div class="item3">
        <div class="hide" id="newUserForm">
          <h4>Looks like you're new!</h4>
          <p class="lead">Please enter new user name below</p>
        </div>
        <div class="hide" id="returnUserGreeting">
        </div>
      </div>
      <div class="item4">Footer
      </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        //localStorage.clear()
        //variables for different divs depending on what's in localStorage
        let returnGreeting = document.querySelector("#returnUserGreeting")
        let newUserSpace = document.querySelector("#newUserForm")

        //check to see if user already has a stored username
          if (localStorage.getItem('userName')) {

            let userName = localStorage.getItem('userName')

            greeting(userName, userName, returnGreeting, newUserSpace)

          } else {
            newUserSpace.style.visibility = "visible"

            let newUserInput = document.createElement("input")
            newUserInput.className = "form-control"
            newUserInput.style.width = "25%"
            newUserInput.setAttribute("type", "text")
            newUserSpace.append(newUserInput)

            let newUserCreate = document.createElement("button")
            newUserCreate.className = "btn btn-primary"
            newUserCreate.innerHTML = "Create"
            newUserCreate.style.margin = "15px"
            newUserSpace.append(newUserCreate)

            //handle user creation
            newUserCreate.onclick = () => {
              if (newUserInput.value) {

                let userName = newUserInput.value
                localStorage.setItem('userName', userName)

                greeting(userName, userName, returnGreeting, newUserSpace)

              }
            }
          }
      })
    </script>
  </body>
</html>
